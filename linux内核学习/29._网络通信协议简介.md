# 网络协议简介

## 分层

![image](https://github.com/ingangi/blog/blob/master/img/osi_layer.png)

### 数据链路层（二层、MAC层）

MAC地址的定位局限于一个网络（同一个网络号的IP地址）内部，可以简单地通过匹配MAC地址来决定是否接收数据。

当跨网络通信时，源/目标IP地址不变，但是源/目标MAC地址都需要改变。

- **交换机**只处理到MAC层，因此是**二层设备**。

### 网络层（三层、IP层）

职责：将网络包从起始IP路由转发到目标IP。

- **路由器**只处理到IP层，因此是**三层设备**。

#### IP地址

> 192.168.1.100/24 

斜线后的24表示：32位的IP地址的前24位是网络号，后8位是主机号。

##### IP地址分类

> 为什么IP地址要分网络号+主机号？

如果不分网络位和主机位，路由器的路由表就是都是32位的地址，那所有的路由器维护的路由表会很大，转发速度会变慢（因为查询变慢）。

有了网络地址，就可以限定拥有相同网络地址的终端都在同一个范围内，那么路由表只需要维护这个网络地址的方向，就可以找到相应的终端了(这些终端)。

- A类：IP/8，网络地址少，主机数庞大。网络地址最高位"0"。

> 所有的A类地址都在美国。 例如，通用电气公司拥有 3.0.0.0/8，苹果电脑公司拥有 17.0.0.0/8，美国邮政总局拥有 56.0.0.0/8。

- B类：IP/16，适用于中等规模规模的网络，每个网络所能容纳的计算机数为6万多台。网络地址最高位"10"。
- C类：IP/24，网络地址数量较多，适用于小规模的局域网络，每个网络最多只能包含254台计算机。网络地址最高位"110"。

### 传输层（四层）

TCP/UDP，根据各自协议特点，实现对传输地控制，引入了端口概念，实现了对同一个机器内部不同应用数据的区分。

> **socket**不属于网络分层概念，而是操作系统里的概念。完成在网络程序开发中，用户态和内核态的衔接。

## 数据怎么走？

层层封装->转发->层层解析。

一个http请求例子：

![image](https://github.com/ingangi/blog/blob/master/img/net_send_flow.jpeg)